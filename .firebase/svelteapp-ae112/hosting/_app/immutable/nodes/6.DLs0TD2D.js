import{s as F,k as R,r as S,i as k,f as h,e as g,a as A,c as v,b as T,g as E,o as b,v as U,h as _,w as B,u as j,x as M,y as Z,t as y,d as C,m as L,j as N}from"../chunks/scheduler.B0JEHspW.js";import{S as G,i as H,c as J,a as K,m as Q,t as W,b as X,d as $}from"../chunks/index.jKw0lUt7.js";import{A as x}from"../chunks/AuthCheck.02JE7e_k.js";import{a as ee,u as te,h as I,i as D,j as se,w as le}from"../chunks/firebase.oGd3CV5t.js";function ne(i){let e,s,n,t,l,a,d,c,w,m=i[1]&&O(i),u=!i[3]&&i[5]&&V(),p=i[3]&&!i[2]&&!i[1]&&Y(i),r=i[2]&&q(i);return{c(){e=g("form"),s=g("input"),n=A(),t=g("div"),m&&m.c(),l=A(),u&&u.c(),a=A(),p&&p.c(),d=A(),r&&r.c(),this.h()},l(o){e=v(o,"FORM",{class:!0});var f=T(e);s=v(f,"INPUT",{type:!0,placeholder:!0,class:!0}),n=E(f),t=v(f,"DIV",{class:!0});var P=T(t);m&&m.l(P),l=E(P),u&&u.l(P),a=E(P),p&&p.l(P),d=E(P),r&&r.l(P),P.forEach(h),f.forEach(h),this.h()},h(){b(s,"type","text"),b(s,"placeholder","Username"),b(s,"class","input w-full"),U(s,"input-error",!i[3]&&i[5]),U(s,"input-warning",i[4]),U(s,"input-success",i[2]&&i[3]&&!i[1]),b(t,"class","my-4 min-h-16 px-8 w-full"),b(e,"class","w-2/5")},m(o,f){k(o,e,f),_(e,s),B(s,i[0]),_(e,n),_(e,t),m&&m.m(t,null),_(t,l),u&&u.m(t,null),_(t,a),p&&p.m(t,null),_(t,d),r&&r.m(t,null),c||(w=[j(s,"input",i[9]),j(s,"input",i[7]),j(e,"submit",M(i[8]))],c=!0)},p(o,f){f&1&&s.value!==o[0]&&B(s,o[0]),f&40&&U(s,"input-error",!o[3]&&o[5]),f&16&&U(s,"input-warning",o[4]),f&14&&U(s,"input-success",o[2]&&o[3]&&!o[1]),o[1]?m?m.p(o,f):(m=O(o),m.c(),m.m(t,l)):m&&(m.d(1),m=null),!o[3]&&o[5]?u||(u=V(),u.c(),u.m(t,a)):u&&(u.d(1),u=null),o[3]&&!o[2]&&!o[1]?p?p.p(o,f):(p=Y(o),p.c(),p.m(t,d)):p&&(p.d(1),p=null),o[2]?r?r.p(o,f):(r=q(o),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(o){o&&h(e),m&&m.d(),u&&u.d(),p&&p.d(),r&&r.d(),c=!1,Z(w)}}}function ie(i){let e,s,n,t,l=i[6].username+"",a,d,c,w="(Usernames cannot be changed)",m,u,p="Upload Profile Image";return{c(){e=g("p"),s=y("Your username is "),n=g("span"),t=y("@"),a=y(l),d=A(),c=g("p"),c.textContent=w,m=A(),u=g("a"),u.textContent=p,this.h()},l(r){e=v(r,"P",{});var o=T(e);s=C(o,"Your username is "),n=v(o,"SPAN",{class:!0});var f=T(n);t=C(f,"@"),a=C(f,l),f.forEach(h),o.forEach(h),d=E(r),c=v(r,"P",{"data-svelte-h":!0}),L(c)!=="svelte-jenitk"&&(c.textContent=w),m=E(r),u=v(r,"A",{href:!0,class:!0,"data-svelte-h":!0}),L(u)!=="svelte-1yl8kvk"&&(u.textContent=p),this.h()},h(){b(n,"class","font-bold text-green-300"),b(u,"href","/login/photo"),b(u,"class","btn btn-primary")},m(r,o){k(r,e,o),_(e,s),_(e,n),_(n,t),_(n,a),k(r,d,o),k(r,c,o),k(r,m,o),k(r,u,o)},p(r,o){o&64&&l!==(l=r[6].username+"")&&N(a,l)},d(r){r&&(h(e),h(d),h(c),h(m),h(u))}}}function O(i){let e,s,n,t;return{c(){e=g("p"),s=y("Checking availability of @"),n=y(i[0]),t=y("..."),this.h()},l(l){e=v(l,"P",{class:!0});var a=T(e);s=C(a,"Checking availability of @"),n=C(a,i[0]),t=C(a,"..."),a.forEach(h),this.h()},h(){b(e,"class","text-secondary")},m(l,a){k(l,e,a),_(e,s),_(e,n),_(e,t)},p(l,a){a&1&&N(n,l[0])},d(l){l&&h(e)}}}function V(i){let e,s="must be 3-16 characters long, alphanumeric only";return{c(){e=g("p"),e.textContent=s,this.h()},l(n){e=v(n,"P",{class:!0,"data-svelte-h":!0}),L(e)!=="svelte-1suomdh"&&(e.textContent=s),this.h()},h(){b(e,"class","text-error text-sm")},m(n,t){k(n,e,t)},d(n){n&&h(e)}}}function Y(i){let e,s,n,t;return{c(){e=g("p"),s=y("@"),n=y(i[0]),t=y(" is not available"),this.h()},l(l){e=v(l,"P",{class:!0});var a=T(e);s=C(a,"@"),n=C(a,i[0]),t=C(a," is not available"),a.forEach(h),this.h()},h(){b(e,"class","text-warning text-sm")},m(l,a){k(l,e,a),_(e,s),_(e,n),_(e,t)},p(l,a){a&1&&N(n,l[0])},d(l){l&&h(e)}}}function q(i){let e,s,n;return{c(){e=g("button"),s=y("Confirm username @"),n=y(i[0]),this.h()},l(t){e=v(t,"BUTTON",{class:!0});var l=T(e);s=C(l,"Confirm username @"),n=C(l,i[0]),l.forEach(h),this.h()},h(){b(e,"class","btn btn-success")},m(t,l){k(t,e,l),_(e,s),_(e,n)},p(t,l){l&1&&N(n,t[0])},d(t){t&&h(e)}}}function ae(i){let e;function s(l,a){var d;return(d=l[6])!=null&&d.username?ie:ne}let n=s(i),t=n(i);return{c(){t.c(),e=S()},l(l){t.l(l),e=S()},m(l,a){t.m(l,a),k(l,e,a)},p(l,a){n===(n=s(l))&&t?t.p(l,a):(t.d(1),t=n(l),t&&(t.c(),t.m(e.parentNode,e)))},d(l){l&&h(e),t.d(l)}}}function oe(i){let e,s;return e=new x({props:{$$slots:{default:[ae]},$$scope:{ctx:i}}}),{c(){J(e.$$.fragment)},l(n){K(e.$$.fragment,n)},m(n,t){Q(e,n,t),s=!0},p(n,[t]){const l={};t&4223&&(l.$$scope={dirty:t,ctx:n}),e.$set(l)},i(n){s||(W(e.$$.fragment,n),s=!0)},o(n){X(e.$$.fragment,n),s=!1},d(n){$(e,n)}}}const re=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function ue(i,e,s){let n,t,l,a,d;R(i,ee,f=>s(11,a=f)),R(i,te,f=>s(6,d=f));let c="",w=!1,m=!1,u;async function p(){s(2,m=!1),clearTimeout(u),s(1,w=!0),u=setTimeout(async()=>{console.log("checking availability of",c);const f=I(D,"usernames",c),P=await se(f).then(z=>z.exists());s(2,m=!P),s(1,w=!1)},500)}async function r(){console.log("confirming username",c);const f=le(D);f.set(I(D,"usernames",c),{uid:a==null?void 0:a.uid}),f.set(I(D,"users",a.uid),{username:c,photoURL:(a==null?void 0:a.photoURL)??null,published:!0,bio:"",links:[{title:"Test Link",url:"https://linknest.com",icon:"chicken"}]}),await f.commit(),s(0,c=""),s(2,m=!1)}function o(){c=this.value,s(0,c)}return i.$$.update=()=>{i.$$.dirty&1&&s(3,n=(c==null?void 0:c.length)>2&&c.length<16&&re.test(c)),i.$$.dirty&1&&s(5,t=c.length>0),i.$$.dirty&14&&s(4,l=n&&!m&&!w)},[c,w,m,n,l,t,d,p,r,o]}class he extends G{constructor(e){super(),H(this,e,ue,oe,F,{})}}export{he as component};
